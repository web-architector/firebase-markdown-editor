(this["webpackJsonpmardown-editor"]=this["webpackJsonpmardown-editor"]||[]).push([[0],{151:function(e,t,n){e.exports=n(460)},156:function(e,t,n){},167:function(e,t,n){},169:function(e,t,n){},458:function(e,t,n){},460:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),o=n.n(c),u=(n(156),n(23)),i=n(146),s=(n(162),n(34)),l=(n(164),n(461),s.apps.length?s.app():s.initializeApp({apiKey:"AIzaSyCSZh_3E5FOk1i43svfJLLeyQSn9HImwkw",authDomain:"markdown-editor-2efef.firebaseapp.com",databaseURL:"https://markdown-editor-2efef.firebaseio.com",projectId:"markdown-editor-2efef",storageBucket:"markdown-editor-2efef.appspot.com",messagingSenderId:"252242878217",appId:"1:252242878217:web:89cd2d47ea52ebb7bdbdd8"})),d=l.auth(),f=l.firestore(),m=l.storage(),p={googleProvider:new s.auth.GoogleAuthProvider,githubProvider:new s.auth.GithubAuthProvider},b=(n(167),Object(i.a)({providers:p,firebaseAppAuth:d})((function(e){var t=e.signInWithGoogle,n=e.signInWithGithub,a=e.signOut,c=e.user,o=e.loading;return r.a.createElement(r.a.Fragment,null,o&&r.a.createElement(L,null),r.a.createElement("header",{className:"header"},r.a.createElement("h2",null,"Smart Markdown"),c&&r.a.createElement("div",{className:"user-profile"},r.a.createElement("a",{className:"log-out-link",href:"#log-out",onClick:function(){console.log("Signed out..."),a()}},"\u0412\u044b\u0439\u0442\u0438"),r.a.createElement("img",{alt:"Profile",className:"avatar",src:c.photoURL}))),r.a.createElement(u.b,null,r.a.createElement(G,{path:"/",user:c,signIns:{signInWithGithub:n,signInWithGoogle:t}}),r.a.createElement(I,{path:"user/:userId",user:c}),r.a.createElement(C,{path:"user/:userId/editor/:fileId",user:c})))}))),h=n(52),g=n(14),v=n.n(g),E=n(29),w=n(30),k=(n(169),function(){var e=Object(E.a)(v.a.mark((function e(t){var n,a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("users").doc(t).get();case 2:if(!(n=e.sent).exists){e.next=11;break}return console.log("User found in database"),e.next=7,f.collection("users").doc(n.id).collection("files").get();case 7:return a=e.sent,r=[],a.forEach((function(e){var t=e.data(),n=t.name,a=t.content;r.push({id:e.id,name:n,content:a})})),e.abrupt("return",r);case 11:return console.log("User not found in database, creating new entry..."),f.collection("users").doc(t).set({}),e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),j=function(){var e=Object(E.a)(v.a.mark((function e(t,n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("users").doc(t).collection("files").add({name:n,content:""});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(E.a)(v.a.mark((function e(t,n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("users").doc(t).collection("files").doc(n).delete();case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(e){var t=e.user,n=e.userId,c=Object(a.useState)(""),o=Object(h.a)(c,2),i=o[0],s=o[1],l=Object(w.a)(n,k),d=l.data,f=l.error;return Object(a.useEffect)((function(){t||Object(u.c)("/")}),[t]),f?r.a.createElement("p",null,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445!"):d?r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i&&(s(""),j(n,i).then((function(e){})),Object(w.b)(n).then((function(e){})))},className:"new-file-form"},r.a.createElement("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430...",value:i,onChange:function(e){return s(e.target.value)}}),r.a.createElement("button",{type:"submit",className:"add-button"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")),r.a.createElement("ul",{className:"files-list"},d.map((function(e){return r.a.createElement("li",{key:e.id,className:"file"},r.a.createElement(u.a,{to:"/user/".concat(n,"/editor/").concat(e.id),className:"link"},e.name),r.a.createElement("button",{type:"button",onClick:function(){O(n,e.id).then((function(){return Object(w.b)(n)}))},className:"delete-button"},"x"))})))):r.a.createElement("p",null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...")},x=n(147),y=n.n(x),N=n(35),S=(n(458),n(459),function(){var e=Object(E.a)(v.a.mark((function e(t,n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("users").doc(t).collection("files").doc(n).get();case 2:return a=e.sent,e.abrupt("return",a.data());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),C=function(e){var t=e.user,n=e.userId,c=e.fileId;Object(a.useEffect)((function(){t||Object(u.c)("/")}),[t]);var o=Object(w.a)([n,c],S),i=o.data,s=o.error,l=Object(a.useState)(null),d=Object(h.a)(l,2),p=d[0],b=d[1];Object(a.useEffect)((function(){void 0!==i&&null===p&&(console.log("Set initial content in state. length=",i.content.length),b(i.content))}),[i,p]);var g=function(e){return N.b.warning("You have unsaved changes!"),e.preventDefault(),e.returnValue="You have unsaved changes!","You have unsaved changes!"};Object(a.useEffect)((function(){return i&&i.content!==p?window.addEventListener("beforeunload",g):window.removeEventListener("beforeunload",g),function(){return window.removeEventListener("beforeunload",g)}}));var k=function(){var e=Object(E.a)(v.a.mark((function e(t){var a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.size<=1e6)){e.next=8;break}return e.next=3,f.collection("users").doc(n).collection("images").add({name:t.name});case 3:return a=e.sent,e.next=6,m.ref().child("users/".concat(n,"/").concat(a.id,"-").concat(t.name)).put(t);case 6:return r=e.sent,e.abrupt("return",r.ref.getDownloadURL());case 8:N.b.error(" Image too big!");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s?r.a.createElement("p",null,"We had an issue while getting the data"):i?r.a.createElement("div",null,r.a.createElement("header",{className:"editor-header"},r.a.createElement(u.a,{className:"back-button",to:"/user/".concat(n)},"<"),r.a.createElement("h3",null,i.name),r.a.createElement("button",{disabled:i.content===p,onClick:function(){f.collection("users").doc(n).collection("files").doc(c).update({content:p}),Object(w.b)([n,c]),N.b.success("Your changes have been saved!")},className:"save-button"},"Save Changes")),r.a.createElement("div",{className:"editor"},r.a.createElement(y.a,{defaultValue:i.content,onChange:function(e){b(e())},uploadImage:k,onShowToast:function(e){return Object(N.b)(e)}})),r.a.createElement(N.a,null)):r.a.createElement("p",null,"Loading...")},G=function(e){var t=e.user,n=e.signIns,c=n.signInWithGoogle,o=n.signInWithGithub;return Object(a.useEffect)((function(){t&&Object(u.c)("/user/".concat(t.uid))}),[t]),r.a.createElement("div",{className:"sign-in-page"},r.a.createElement("h3",null,"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440  Smart Markdown!"),r.a.createElement("p",null,"\u0414\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0412\u0430\u0448\u0438\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430\u043c\u0438 \u0432\u043e\u0439\u0434\u0438\u0442\u0435, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043e\u0434\u043d\u0443 \u0438\u0437 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438"),r.a.createElement("div",{className:"sign-in-buttons"},r.a.createElement("button",{type:"button",onClick:c},"\u0412\u0445\u043e\u0434 \u0447\u0435\u0440\u0435\u0437 Google"),r.a.createElement("button",{type:"button",onClick:o},"\u0412\u0445\u043e\u0434 \u0447\u0435\u0440\u0435\u0437 GitHub")))},L=function(){return r.a.createElement("div",{style:{position:"fixed",display:"flex",top:0,alignItems:"center",justifyContent:"center",width:"100%",height:"2.68em",background:"green",color:"white"}},"Loading..")};o.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null)),document.getElementById("root"))}},[[151,1,2]]]);
//# sourceMappingURL=main.95dae411.chunk.js.map